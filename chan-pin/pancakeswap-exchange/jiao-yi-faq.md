# 交易 FAQ



## 兑换相关问题

### V3 交易系统有什么新的特点？

* 集中的流动性 - 流动性将集中在交易最活跃的价格区间，这意味着
  * 对交易者来说，更低的交易滑点
  * 对流动性提供者来说，可能有更多的 LP 费用奖励
* 灵活的交易费用结构 - 流动性提供者在创建流动性对或提供流动性时可以选择多个交易费用级别&#x20;
* 可自定义的价格区间 - 流动性提供者也可以选择他们想要提供流动性的价格区间&#x20;
* 非同质化流动性仓位 - 每个流动性仓位都将有其独特的 ID，对应其不同的配置（如价格区间设置）。因此，你将能够创建和保留相同代币对但具有不同区间配置和流动性金额的多个仓位&#x20;
* 反向兼容 - v3 交易系统也将调用传统的 v2 和稳定币兑换的流动性，并计算出能达到最佳价格的交易路径
* 内置限价单 - 进阶的使用者也可以将自定义价格区间这个功能，当作一个有效的限价单来使用，添加流动性后，当价格达到目标时，添加的代币将全部变成单一目标代币。



### 我可以把我自己的代币的流动性添加到 v3 吗？&#x20;

每个人都可以通过在 v3 上存入流动资金来创建流动资金池。&#x20;

但是目前**不支持**以下代币：&#x20;

* 转账收费代币（又称抽税）
* 弹性供应代币 （具 rebase 机制）

对于这些代币，请**不要**在 v3 中添加流动性。你的资产可能会卡在流动性中。



### 为什么我的链上操作不成功？

PancakeSwap 是一个 DeFi 应用程序，它与钱包交互以完成包括交易、创建 LP、在农场和糖浆池中质押等链上操作。&#x20;

#### Gas 费&#x20;

首先要确保你有**足够的 BNB 来支付链上操作的 Gas 费**。通常 Gas 费用会根据链上正排队中的待处理事务（transactions) 数量而波动，如果队列中有很多笔交易排队中，可能需要花费更高的 Gas 费用才能成功上链。在 BNB 智能链上，Gas 费通常按 BNB 计费从几美分到 1 美元不等。在此处了解有关 [Gas费的更多信息](https://academy.binance.com/en/glossary/gas)。

#### 交易费用（Transaction Fees）&#x20;

如果你的交易未成功并且显示错误，你可以修改滑点 - 你可能需要检查尝试交易的代币是否有任何**交易费用**（俗称抽税）**和交易限制**。&#x20;

BNB 智能链上的代币在其合约中包含**交易费用**的情况并不少见，通常这些费用会被用于销毁、资助公平启动项目的金库——例如， [APX 代币对每笔交易都发送 1% 到销毁地址](https://apollox-finance.gitbook.io/apollox-finance/welcome/apx-token-and-contract/tax)，频繁的交易意味着更多的销毁，为 APX 代币持有者增加价值。

由于交易费用的存在，无论是包含（部分交易金额发送到你的地址以外的其他地方，因此输出代币价值低于你按照输入价值计算出的预期价值）还是不包含（需要自你的钱包地址进行额外转帐以发送额外的代币，因此输入代币价值大大超过估计输出价值），它都会影响你同意签署的交易的输入和输出金额。在很多情况下，因抽税的缘故，同一个交易（transaction）中输出之价值与输入之价值难以匹配。&#x20;

#### 交易带有交易费用（Transaction Fees）机制的代币

在你交换任何代币之前，请确保你已访问过他们的网站以了解他们是否有交易费用机制（或着许多项目所说的抽税）。如果有，请确保你设置的滑点足以容纳交易费用——例如如果交易费为 5%，则你的滑点必须设置为至少 5% 加上正常交易滑点，具体取决于你的交易金额和代币的流动性，例如 5.5%-6%。&#x20;

在一些极端情况下，包括一些骗局，一些代币甚至限制链上大部分或者全部的转账，或者只允许某些特定地址出售，在这种情况下，你将无法成功兑换代币。请务必了解你尝试兑换的代币，并注意任何可能的费用和限制条件



### 新的兑换界面中进行兑换是否会调用 v2 或 Stableswap 的流动性？&#x20;

会调用。新的 v3 交易系统将会根据情况调用到 PancakeSwap v3、v2 和 Stableswap的流动性，以获得最佳交易路径。



### 什么是拆分路由？&#x20;

在 v3 交易系统中，你的交易可能被分成多条路径以最佳的汇率执行你的交易。&#x20;

要查看关于你的交易如何拆分的更多细节，请点击 “路径"部分的 "放大镜 "按钮来展开并查看细节。&#x20;

点击[这里](broken-reference)了解更多。



### 如何自定义或禁用某些流动性来源？&#x20;

新的 v3 交易系统调用来自 PancakeSwap v3、V2 和 Stableswap的流动性，以获得最佳交易路径。但是如果你不希望你的交易路径通过某些流动性来源，你可以自定义或禁用这些流动性来源。&#x20;

在查看交易路径时，你可以点击 "自定义路由 "按钮。或者点击兑换界面右上角的齿轮⚙️ 按钮，选择 "自定义路由"。&#x20;

在弹出的 "自定义路由 "界面中，你可以选择你想调用的流动性来源，或者完全禁用多跳。&#x20;

注意：禁用多跳可能会导致特定交易对的滑点增加或交易率下降。请谨慎行事。&#x20;

点击[这里](broken-reference)了解更多。

## 流动性相关问题

### 什么是费用级别，如何挑选正确的费用级别？&#x20;

当你在 v3 中提供流动性时，你可以为同一代币对选择几种不同的交易费用（0.01%、0.05%、0.25% 和 0.1%）。&#x20;

例如，对于 CAKE-BNB，有一个 0.25% 的费用级别，这意味着每笔交易都收取 0.25% 的交易费用。但是一些流动性提供者可能会选择费率为 0.05% 为 CAKE-BNB 交易对提供流动性，以此提供更好的报价并吸引更多的交易量。&#x20;

选择哪个交易费用级别并没有 "正确 "答案。这取决于交易对内的代币。通常情况下，波动性大的代币应该有较高的交易费用，以更好地补偿波动性带来的无常损失。另一方面，稳定币等代币的价格波动较小，无常损失较低，因此其交易费用应该较低。&#x20;

在选择代币对时，"添加流动性 "界面会自动为你选择最受欢迎的费用级别。



### 为什么我添加的流动性中两个代币的美元价值不相等？&#x20;

在 v3 中，流动性仓位中的相关资产并不总是具有相等的美元价值。这将取决于仓位的价格区间设置和该代币对的当前价格。&#x20;

事实上如果当前价格超出了你的仓位的价格区间，所有的代币将被转换为单币。此外你可以在提供流动性设置一个不包括当前市场价格的价格区间，并只存入单一资产。继续阅读以了解更多⬇️



### 如果当前价格超出我的流动性仓位设置的价格区间会怎样？&#x20;

如果当前价格超出了你的仓位所设置的价格区间，你将不会获得任何交易费用奖励。&#x20;

除此之外，对应流动性仓位中的代币将根据价格条件的方向转换为单币。&#x20;

举例说明，如果 CAKE/BUSD 的仓位配置的价格区间是3 BUSD/CAKE 到5 BUSD/CAKE。而如果 CAKE 价格高于或等于 5BUSD/CAKE，则该仓位中的所有资产将被转换为 BUSD，反之亦然。&#x20;

请注意，如果当前价格回到区间内，你不需要额外的操作，你将重新开始获得交易费用奖励。



### 总是添加较小价格区间的流动性是否更好？

为较小的价格区间提供流动性将有助于将你的流动性集中在一个特定的价格区间，提高你在该价格区间内的总流动性的相对份额，因此有可能赚取更多的交易费用奖励。&#x20;

但是请谨记，只有活跃的流动性仓位才能从交易中获得交易费用奖励。这意味着你只有在当前交易价格在流动性仓位设置的价格区间内时才会获得奖励。



### 有什么方法可以自动调整我的仓位，使其始终处于价格区间内并赚取交易费用奖励？&#x20;

自动仓位管理工具即将出现在 PancakeSwap v3 中，并带有一键添加流动性（Zap!）。更多详情请保持关注。



### V3 的交易手续费如何分配?

|           | 0.01% | 0.05% | 0.25% | 1%  |
| --------- | ----- | ----- | ----- | --- |
| 流动性提供者    | 67%   | 66%   | 68%   | 68% |
| CAKE 销毁   | 10%   | 10%   | 23%   | 23% |
| 团队金库      | 18%   | 19%   | 9%    | 9%  |
| CAKE 锁仓用户 | 5%    | 5%    | 0%    |     |



### LP 费用奖励是否像 v2 那样自动复利？&#x20;

不是的。

在 v3 中，你需要手动领取交易费用奖励。你可以在流动性页面上找到你所有的 v3 流动性仓位并在对应的仓位下方领取交易费用奖励。



### 影响 LP APR 的因素有哪些？&#x20;

在 v3 中，不同流动性仓位的 LP 费用奖励 APR 可能不同。它是基于以下影响因素：&#x20;

* 交易量\
  \-更多的交易量会产生更多的费用奖励
* 流动性代币对的费用级别\
  \-较高的费用级别，从单一笔交易中产生的交易费用奖励也较高
* 流动性仓位中添加的代币数额\
  \-添加的代币数额越大，在总共有效流动性中占有越大的相对份额，这将从交易中获得更多的交易费奖励。
* 设置的价格区间\
  \-设置较小的价格区间时，在添加相同数量的代币下拥有较高的流动性集中度，这意味着相对于总有效流动性，此笔流动性占更大份额，并可以从交易中获得更多的交易费奖励。&#x20;
* 目前有效的流动性的金额\
  \-如果有更多的用户在与你相同的区间存入并集中他们的流动性，你将获得较少的交易费用，因为相对于总共的份额较小。&#x20;
* 流动性仓位是否处于有效状态\
  \-只有处于有效状态的流动性仓位才能获得交易费用奖励



### 我可以提供 v2 的流动性吗？&#x20;

提供 v2 流动性不再是明智之举。我们建议添加 v3 流动性，以运用新的功能来提高资金效率。&#x20;

如果你依然想添加 v2 流动性：&#x20;

* 如果该代币对没有 v3 池，或者它在 v2 中的流动性数额超过 v3 中最大的池。输入代币对后流动性页面将出现 "添加 v2 流动性"。你只需点击即可切换到添加 v2 流动性。
* &#x20;或者你可以在 URL 中使用 `/v2` 以直跳转到 v2 流动性添加页面。



### 为什么我不能为刚创建的代币对添加流动性？&#x20;

这是由于 V2 交易系统遗留的一个 bug（存在于每个 UniSwap V2 forks 中），如果一个代币对是以下情况，将无法透過 PancakeSwap 流动性添加界面、或者通过调用合约来为该代币对添加流动性：&#x20;

* 在 FactoryV2 上调用 `createPair`  创建，但未存入初始流动性和铸造初始 LP 代币&#x20;
* 然后，有人将代币对中的其中一种代币转入了流动性池合约中，并调用了`sync`

{% hint style="info" %}
最近在 BNB 链上的 PancakeSwap Exchange V2 上观察到越来越多的此类攻击。&#x20;

我们强烈建议您使用我们的用户界面 (UI) 来创建代币对，您可以透过直接为代币添加初始流动性来达成。
{% endhint %}

大厨们正在努力寻找这一问题的解决办法。下面是使用 BscScan 解决这一问题的分步指南：

#### 找到对应流动性池地址及其 BscScan 页面&#x20;

<div align="left">

<figure><img src="../../.gitbook/assets/cannot add v2 liquidity error pump.jpg" alt="" width="280"><figcaption></figcaption></figure>

</div>

如果您的代币对受到此类攻击影响，您将会看到一个错误提示弹窗，这里您可以看到 BscScan 上该代币对/流动性池页面链接。

或者，您可以前往 Factory V2 ([Bsc](https://bscscan.com/address/0xca143ce32fe78f1f7019d7d551a6402fc5350c73#readContract))，在合约页面选择 "Read contract"，"6. getPair"，输入您的代币对中两个代币的地址，然后点击 "Query"。之后您应该会在返回字段中看到代币对地址（即流动性池地址）。

#### 查看已存入流动性池合约的是哪个代币，并手动将另一个代币转入流动性池合约地址中

![](<../../.gitbook/assets/image (305).png>)

在 BscScan 页面中的代币余额区域（BEP-20 Tokens 标题下方），查看哪种代币已存入池中。通常，已转入的代币是代币对中的配对代币。（如 WBNB、USDT 等......）&#x20;

然后，您必须手动将缺失的另一种代币转入流动性池合约地址。您可以透过在任意钱包应用程序中，输入流动性池地址作为接收方来操作转账。&#x20;

转入的代币数量可以任填，但由于此操作是向流动性池 "捐赠" 代币，透过这种方式添加的流动性将不会铸造流动性凭证代币（CAKE-LP）。因此，我们建议只转入极少量的代币。

{% hint style="warning" %}
重要提示：向流动性池中转入代币后，必须立即在池子的合约上调用 `sync()`。
{% endhint %}

如何调用`sync()？`您可以在代币对的 BscScan 页面，前往 "Write contract"，"8.Sync" 并点击 "Write" 按钮。您需要先在页面连接钱包后，才能执行此链上操作。

上链完成并且被纳入区块后，您就可以在 PancakeSwap 流动性界面上进行后续的流动性添加操作了。

### 如何设定代币的发行价格？

发行价格由池子内两种代币的比例决定。因此在向池子转入代币并进行修复流动性池当下，您就需要计算好要转入的代币数量，透过调整池子内两种代币的比例来定义代币的发行价。\
\
可使用以下方法计算要转账到池子内的数量：

* `tokenInside`：已转入池中的代币。通常应该是代币对中的常用配对代币。(如 WBNB、USDT 等......）。
* `tokenToSend`：即将转入到池中的代币。通常应该是您的项目代币。
* `tokenInside.price`：池子中已存在代币的美元价格。
* `tokenToSend.price`：即将转入到池中的代币的美元价格（即发行价格） 。
* `pool`：v2 池

计算公式如下：

`amountToSend = tokenInside.balanceOf(pool) / tokenInside.decimal() * tokenInside.price / tokenToSend.price * tokenToSend.decimal()`

如果结果小于 0（通常发生在发行价格非常高的情况下），您需要先转帐一些`tokenInside` 代币进入池中。



### 如何操作稳定币 LP（stable LP）和传统的 V2 LP？&#x20;

你可以像往常一样进入 [流动性页面](https://pancakeswap.finance/liquidity) 来操作并管理它们。



### 为什么我需要在启用/授权前重置 USDT 的授权？&#x20;

在以太坊主网上运行时，USDT 代币遵循不同的逻辑管理授权和代币限额。&#x20;

因此，当支出限额过低时。它会要求您在设置新的授权之前重置授权。
